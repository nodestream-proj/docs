<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Software Vulnerability Analysis using SBOMs, Amazon Neptune, and Nodestream | Nodestream</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://nodestream-proj.github.io/docs/blog/2024/04/05/nodestream-sbom-preview/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Software Vulnerability Analysis using SBOMs, Amazon Neptune, and Nodestream | Nodestream"><meta data-rh="true" name="description" content="Note: Both the Nodestream Neptune and Nodestream SBOM plugins are currently preview releases"><meta data-rh="true" property="og:description" content="Note: Both the Nodestream Neptune and Nodestream SBOM plugins are currently preview releases"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-04-05T00:00:00.000Z"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://nodestream-proj.github.io/docs/blog/2024/04/05/nodestream-sbom-preview/"><link data-rh="true" rel="alternate" href="https://nodestream-proj.github.io/docs/blog/2024/04/05/nodestream-sbom-preview/" hreflang="en"><link data-rh="true" rel="alternate" href="https://nodestream-proj.github.io/docs/blog/2024/04/05/nodestream-sbom-preview/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="Nodestream RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="Nodestream Atom Feed"><link rel="stylesheet" href="/docs/assets/css/styles.2d4dafe8.css">
<script src="/docs/assets/js/runtime~main.5b5619fb.js" defer="defer"></script>
<script src="/docs/assets/js/main.d316cca9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/nodestream.png" alt="Nodestream Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/nodestream.png" alt="Nodestream Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Nodestream</b></a><a class="navbar__item navbar__link" href="/docs/docs/intro/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/nodestream-proj/nodestream" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/2024/04/05/nodestream-0-12/">Nodestream 0.12 Release</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/docs/blog/2024/04/05/nodestream-sbom-preview/">Software Vulnerability Analysis using SBOMs, Amazon Neptune, and Nodestream</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/blog/welcome/">Welcome</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Note: Both the Nodestream Neptune and Nodestream SBOM plugins are currently preview releases"><header><h1 class="title_f1Hy" itemprop="headline">Software Vulnerability Analysis using SBOMs, Amazon Neptune, and Nodestream</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-04-05T00:00:00.000Z" itemprop="datePublished">April 5, 2024</time> · <!-- -->8 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><strong>Note</strong>: Both the Nodestream Neptune and Nodestream SBOM plugins are currently preview releases</p>
<p>Recently, (March 2024) <a href="https://www.cisecurity.org/advisory/a-vulnerability-in-xz-utils-could-allow-for-remote-code-execution_2024-033" target="_blank" rel="noopener noreferrer">a severe vulnerability was found to have been added to a common library, XZ utility</a>. Unfortunately, serious software vulnerabilities are not isolated incidents, as in late 2021, a <a href="https://www.ncsc.gov.uk/information/log4j-vulnerability-what-everyone-needs-to-know" target="_blank" rel="noopener noreferrer">critical security vulnerability was discovered in a commonly used logging library, Log4j</a>. While the origin of the issues differ, Log4j was an oversight while XZ was an explicit backdoor, the outcome for users was the end same. Once each vulnerability was known, companies and individuals spent many hours combing through countless applications, looking for and patching systems running vulnerable versions of the software.</p>
<p>As this effort was ongoing, many were asking, &quot;Isn&#x27;t there a better way to track this information?&quot;</p>
<p>In this post, we will discuss the work we have been doing around creating a plugin for Nodestream that provides a unified graph model for SBOMs ingestion and analysis. We will combine this with the plugin for Amazon Neptune to demonstrate how you can find insights for software vulnerabilities in application stacks. Let’s first talk a bit about what an SBOM is and why you should use a graph for analysis.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-software-bill-of-materials-sbom-and-why-use-graphs">What is a Software Bill of Materials (SBOM) and why use Graphs<a href="#what-is-a-software-bill-of-materials-sbom-and-why-use-graphs" class="hash-link" aria-label="Direct link to What is a Software Bill of Materials (SBOM) and why use Graphs" title="Direct link to What is a Software Bill of Materials (SBOM) and why use Graphs">​</a></h2>
<p>A software bill of materials (SBOM) is a critical component of software development and management, helping organizations to improve the transparency, security, and reliability of their software applications. An SBOM acts as an &quot;ingredient list&quot; of libraries and components of a software application that:</p>
<ul>
<li>Enables software creators to track dependencies within their applications</li>
<li>Provides security personnel the ability to examine and assess the risk of potential vulnerabilities within an environment</li>
<li>Provides legal personnel with the information needed to assure that a particular software is in compliance with all licensing requirements.</li>
</ul>
<p>A software bill of materials (SBOM) is a comprehensive list of the components, libraries, and dependencies used in a software application or system. It provides a detailed breakdown of the software&#x27;s architecture, including the names, versions, licenses, and optionally the vulnerabilities of each component and describes the complex dependencies and relationships between components of a software system, including multi-level hierarchies and recursive relationships.</p>
<p>Graphs are excellent for modeling these kinds of interconnected relationships, with nodes representing components and edges representing dependencies and relationships between these components. Graph data structures handle recursive relationships very naturally, making it easy to analyze networks and flows. Using graph algorithms and metrics, allows you to analyze and identify critical components and dependencies, single points of failure, security vulnerabilities, license compatibilities, etc. for use cases such as:</p>
<ul>
<li>Dependency graphs - These show how different components in the software relate to and depend on each other. Graphs make these complex relationships easier to visualize.</li>
<li>Vulnerability Graphs - Graphs make it easy to determine and assign associated risks with different vulnerabilities to prioritize fixing known issues.</li>
<li>Supply chain graphs - SBOMs trace the components and dependencies up the software supply chain. Graphs can illustrate the flow of open-source components from lower-level suppliers up to the final product. This helps identify vulnerabilities or licensing issues in the supply chain.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-graphs-for-sbom-analysis">How to use Graphs for SBOM analysis<a href="#how-to-use-graphs-for-sbom-analysis" class="hash-link" aria-label="Direct link to How to use Graphs for SBOM analysis" title="Direct link to How to use Graphs for SBOM analysis">​</a></h2>
<p>While using graphs to assist with SBOM analysis is not new, it also has not been trivial to get the data loaded in due to differing formats, with the two most popular being <a href="https://cyclonedx.org/" target="_blank" rel="noopener noreferrer">CycloneDX</a> and <a href="https://spdx.dev/" target="_blank" rel="noopener noreferrer">SPDX</a>. To assist with the data loading and analysis, I recently worked on an <a href="https://github.com/nodestream-proj/nodestream-plugin-sbom/tree/main" target="_blank" rel="noopener noreferrer">SBOM plugin</a> for <a href="https://nodestream-proj.github.io/docs/docs/intro/" target="_blank" rel="noopener noreferrer">Nodestream</a> to provide a simple way to load SBOMs into an opinionated graph data model from local files, GitHub, or Amazon Inspector. <a href="https://nodestream-proj.github.io/docs/docs/intro/" target="_blank" rel="noopener noreferrer">Nodestream</a> is a Python framework for performing graph database ETL. The SBOM plugin extends this framework to provide a</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="loading-data-into-sboms-into-our-graph">Loading Data into SBOMs into our Graph<a href="#loading-data-into-sboms-into-our-graph" class="hash-link" aria-label="Direct link to Loading Data into SBOMs into our Graph" title="Direct link to Loading Data into SBOMs into our Graph">​</a></h3>
<p>To get started loading your SBOM files into Amazon Neptune, we first need to setup an Amazon Neptune Analytics Graph as well as a Neptune Notebook to perform our analysis. To configure a Neptune Analytics Graph you can follow the documentation here: <a href="https://docs.aws.amazon.com/neptune-analytics/latest/userguide/create-graph-using-console.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/neptune-analytics/latest/userguide/create-graph-using-console.html</a></p>
<p>Neptune Notebooks is a managed open-source graph-notebook project provides a plethora of Jupyter extensions and sample notebooks that make it easy to interact with and learn to use a Neptune Analytics graph. This can be configured using the documentation here: <a href="https://docs.aws.amazon.com/neptune-analytics/latest/userguide/notebooks.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/neptune-analytics/latest/userguide/notebooks.html</a></p>
<p>Now that we have setup our database and analysis environment we next need to install the Nodestream plugins for Neptune and SBOM.</p>
<p><code>pip install -q pyyaml nodestream-plugin-neptune nodestream-plugin-sbom</code></p>
<p>With those data files installed, all we need to do is set our configuration in the <code>nodestream.yaml</code> file as shown below. In this example, we are going to load the SBOM files for Nodestream, the Nodestream Neptune Plugin, and the Nodestream SBOM plugin into our database, directly from GitHub.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">plugins:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: sbom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repos:[nodestream-proj/nodestream, nodestream-proj/nodestream-plugin-sbom, nodestream-proj/nodestream-plugin-neptune]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">targets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my-neptune:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: neptune</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graph_id: g-&lt;GRAPH ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mode: analytics</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With our configuration setup, we can run the import using the following command:</p>
<p><code>nodestream run sbom_github --target my-neptune</code></p>
<p>After we run the data load, we get a graph that similar to the image below.</p>
<p><img decoding="async" loading="lazy" alt="SBOM Model Overview" src="/docs/assets/images/sbom_overview-11f78470eba485ca6b53f6be5c6c0cc6.png" title="SBOM Data Overview" width="1422" height="1324" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-our-graph-look-like">What does our graph look like?<a href="#what-does-our-graph-look-like" class="hash-link" aria-label="Direct link to What does our graph look like?" title="Direct link to What does our graph look like?">​</a></h3>
<p>Let’s take a look at the types of data that we are storing in our graph. The plugin uses the opinionated graph data model shown below to represent SBOM data files.
<img decoding="async" loading="lazy" alt="SBOM Graph schema" src="/docs/assets/images/schema-060f6f9a4f1036b5c1af339fd68d47fe.png" title="SBOM Graph Schema" width="581" height="481" class="img_ev3q">
This model contains the following elements:</p>
<p><strong>Node Types</strong></p>
<ul>
<li><code>Document</code> - This represents the SBOM document as well as the metadata associated with that SBOM.</li>
<li><code>Component</code> - This represents a specific component of a software system.</li>
<li><code>Reference</code> - This represents a reference to any external system which the system wanted to include as a reference. This can range from package managers, URLs to external websites, etc.</li>
<li><code>Vulnerability</code> - This represents a specific known vulnerability for a component.</li>
<li><code>License</code> - The license for the component or package.</li>
</ul>
<p><strong>Edge Types</strong></p>
<ul>
<li><code>DESCRIBES</code>/<code>DEPENDS_ON</code>/<code>DEPENDENCY_OF</code>/<code>DESCRIBED_BY</code>/<code>CONTAINS</code> - This represents the type of relationship between a <code>Document</code> and a <code>Component</code> in the system.</li>
<li><code>REFERS_TO</code> - This represents a reference between a <code>Component</code> and a <code>Reference</code></li>
<li><code>AFFECTS</code> - This represents that a particular <code>Component</code> is affected by the connected <code>Vulnerability</code></li>
</ul>
<p>The properties associated with each element will vary depending on the input format used, and the optional information contained in each file.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="analyzing-sboms">Analyzing SBOMs<a href="#analyzing-sboms" class="hash-link" aria-label="Direct link to Analyzing SBOMs" title="Direct link to Analyzing SBOMs">​</a></h2>
<p>Now that we have our data loaded into our graph, the next step is to start to extract insights into what is actually important in our SBOM data.</p>
<p>One common use case is to investigate shared dependencies across projects. Shared dependencies allow development and security teams to better understand the security posture of the organization through identification of shared risks. Let&#x27;s start by taking a look at the most shared dependencies between these projects using the query below.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (n:Component)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE exists(n.name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CALL neptune.algo.degree(n, {traversalDirection: &#x27;inbound&#x27;, edgeLabels: [&#x27;DEPENDS_ON&#x27;]})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YIELD node, degree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN node.name, degree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY degree DESC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIMIT 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Running this query will show us that there are quite a few dependencies that are shared across all three projects. To do this analysis, we used a graph algorithm known as <a href="https://docs.aws.amazon.com/neptune-analytics/latest/userguide/degree.html" target="_blank" rel="noopener noreferrer">Degree Centrality</a> which counts the number of edges connected to a node. This measure of how connected the node is can in turn indicate the node&#x27;s importance and level of influence in the network.
<img decoding="async" loading="lazy" alt="Results" src="/docs/assets/images/analyze_query_1-caba0b29d04a259615e94657bad62d68.png" title="Results" width="899" height="359" class="img_ev3q">
Running the query below shows us that there are 31 <code>Components</code> that are shared across all the projects.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (n:Component)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE exists(n.name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CALL neptune.algo.degree(n, {traversalDirection: &#x27;inbound&#x27;, edgeLabels: [&#x27;DEPENDS_ON&#x27;]})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YIELD node, degree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE degree=3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN count(node)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Given that this is a closely connected group of projects, it is not a surprise that there are many shared components. Given that one of the strengths of graphs is the ability to visualize the connectedness between data, let’s take a look at how they are connected.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH (n:Component)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE exists(n.name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CALL neptune.algo.degree(n, {traversalDirection: &#x27;inbound&#x27;, edgeLabels: [&#x27;DEPENDS_ON&#x27;]})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">YIELD node, degree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE degree = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WITH node, degree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MATCH p=(node)-[]-()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Results" src="/docs/assets/images/analyze_query_2-1f39a8b8627249ee7c26b96efd2b5423.png" title="Results" width="1154" height="1107" class="img_ev3q"></p>
<p>Another common use case is to investigate licensing across multiple projects. This sort of investigation benefits from the connectedness across the graph by leveraging the connectedness to find how component licenses are connected to each other. Let’s take a look at what other licenses are associated with the <code>lgpl-2.1-or-later</code> licensed components.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH p=(l:License)&lt;-[:LICENSED_BY]-(:Component)&lt;-[:DEPENDS_ON]-(:Document)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-[:DEPENDS_ON]-&gt;(:Component)-[:LICENSED_BY]-&gt;(l2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE l.name = &#x27;lgpl-2.1-or-later&#x27; and l&lt;&gt;l2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN DISTINCT l2.name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Results" src="/docs/assets/images/analyze_query_3-251a3b3cceab1a4c22d933c067766035.png" title="Results" width="908" height="456" class="img_ev3q"></p>
<p>As we see, there are quite a few other licenses used in these projects. We can leverage the visual nature of graph results to gain some insight into how components are connected. In this case, let’s see how components with the <code>lgpl-2.1-or-later</code> are connected to components with the <code>unlicense</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MATCH p=(l:License)←[:LICENSED_BY]-(:Component)←[:DEPENDS_ON]-(:Document)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-[:DEPENDS_ON]→(:Component)-[:LICENSED_BY]→(l2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE l.name = &#x27;lgpl-2.1-or-later&#x27; and l&lt;&gt;l2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RETURN DISTINCT l2.name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Results" src="/docs/assets/images/analyze_query_4-f60d2400b6913194c5ed7fde6d7abc34.png" title="Results" width="565" height="425" class="img_ev3q"></p>
<p>We see that there exists one path in our graph between these two licenses.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<p>As we have seen, using graphs to perform analysis of SBOM data can be a powerful tool in your toolbox to gain insights into the connections between software projects. What I have shown here is only the beginning of the types of analysis you can perform with this data. For a more detailed walkthrough of using graphs for SBOM analysis, I recommend taking a look at the following notebooks:</p>
<p><a href="https://github.com/aws/graph-notebook/blob/ISSUE-558/src/graph_notebook/notebooks/02-Neptune-Analytics/03-Sample-Use-Cases/03-Software-Bill-Of-Materials/01-SBOM-Dependency-Analysis.ipynb" target="_blank" rel="noopener noreferrer">SBOM Dependency Analysis</a>
<a href="https://github.com/aws/graph-notebook/blob/ISSUE-558/src/graph_notebook/notebooks/02-Neptune-Analytics/03-Sample-Use-Cases/03-Software-Bill-Of-Materials/02-SBOM-Vulnerability-Analysis.ipynb" target="_blank" rel="noopener noreferrer">SBOM Vulnerability Analysis</a></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/nodesteram-proj/docs/tree/main/packages/create-docusaurus/templates/shared/blog/2024-04-05-nodestream-sbom-preview/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/blog/2024/04/05/nodestream-0-12/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Nodestream 0.12 Release</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/blog/welcome/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Welcome</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-software-bill-of-materials-sbom-and-why-use-graphs" class="table-of-contents__link toc-highlight">What is a Software Bill of Materials (SBOM) and why use Graphs</a></li><li><a href="#how-to-use-graphs-for-sbom-analysis" class="table-of-contents__link toc-highlight">How to use Graphs for SBOM analysis</a><ul><li><a href="#loading-data-into-sboms-into-our-graph" class="table-of-contents__link toc-highlight">Loading Data into SBOMs into our Graph</a></li><li><a href="#what-does-our-graph-look-like" class="table-of-contents__link toc-highlight">What does our graph look like?</a></li></ul></li><li><a href="#analyzing-sboms" class="table-of-contents__link toc-highlight">Analyzing SBOMs</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/docs/intro/">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/orgs/nodestream-proj/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/nodestream-proj/nodestream" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Nodestream Project.</div></div></div></footer></div>
</body>
</html>